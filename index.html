<!DOCTYPE html>
<html>
<head>
    <title>Battery Flap</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            text-align: center;
            color: white;
            background: #000;
        }

        h2 {
            margin-top: 10px;
        }

        canvas {
            display: block;
            margin: 10px auto;
            border: 3px solid white;
            background: #111;
        }
    </style>
</head>
<body>

<h2>ðŸ”‹ New Energy New York Battery Jump!</h2>
<p>Press SPACE to Flap</p>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let bird;
let pipes;
let score;
let gameOver;
let gameStarted;

function resetGame() {
    bird = {
        x: 80,
        y: 300,
        width: 30,
        height: 30,
        gravity: 0.6,
        lift: -10,
        velocity: 0
    };

    pipes = [];
    score = 0;
    gameOver = false;
    gameStarted = false;
}

resetGame();

function createPipe() {
    const gap = 150;
    const topHeight = Math.random() * 300 + 50;

    pipes.push({
        x: canvas.width,
        top: topHeight,
        bottom: canvas.height - topHeight - gap,
        width: 50
    });
}

function update() {
    if (!gameStarted || gameOver) return;

    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    if (bird.y + bird.height > canvas.height || bird.y < 0) {
        gameOver = true;
    }

    if (pipes.length === 0 || pipes[pipes.length - 1].x < 250) {
        createPipe();
    }

    pipes.forEach(pipe => {
        pipe.x -= 2;

        if (
            bird.x < pipe.x + pipe.width &&
            bird.x + bird.width > pipe.x &&
            (bird.y < pipe.top || bird.y + bird.height > canvas.height - pipe.bottom)
        ) {
            gameOver = true;
        }

        if (pipe.x + pipe.width === bird.x) {
            score++;
        }
    });

    pipes = pipes.filter(pipe => pipe.x + pipe.width > 0);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Bird
    ctx.fillStyle = "yellow";
    ctx.fillRect(bird.x, bird.y, bird.width, bird.height);

    // Pipes
    ctx.fillStyle = "green";
    pipes.forEach(pipe => {
        ctx.fillRect(pipe.x, 0, pipe.width, pipe.top);
        ctx.fillRect(pipe.x, canvas.height - pipe.bottom, pipe.width, pipe.bottom);
    });

    // Score
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText("Score: " + score, 10, 30);

    // Start Screen
    if (!gameStarted && !gameOver) {
        ctx.fillStyle = "#ADD8E6";
        ctx.fillRect(60, 230, 280, 100);

        ctx.fillStyle = "#003366";
        ctx.textAlign = "center";
        ctx.font = "24px Arial";
        ctx.fillText("Press SPACE to Start", canvas.width / 2, 280);
        ctx.textAlign = "left";
    }

    // Game Over Screen
    if (gameOver) {
        ctx.fillStyle = "#ADD8E6";
        ctx.fillRect(60, 210, 280, 140);

        ctx.fillStyle = "#003366";
        ctx.textAlign = "center";

        ctx.font = "30px Arial";
        ctx.fillText("GAME OVER", canvas.width / 2, 260);

        ctx.font = "20px Arial";
        ctx.fillText("Press SPACE to Restart", canvas.width / 2, 300);

        ctx.textAlign = "left";
    }
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

gameLoop();

document.addEventListener("keydown", function(e) {
    if (e.code === "Space") {
        if (!gameStarted) {
            gameStarted = true;
        } else if (gameOver) {
            resetGame();
            gameStarted = true;
        } else {
            bird.velocity = bird.lift;
        }
    }
});
</script>

</body>
</html>
